function printHeader(print)
{
  //print.printBarcode(frontol.currentDocument.barcode,1,50,100)
  print.printLRStringLF("РМ №"+frontol.codeWorkplace,frontol.currentUser.name," ");
  print.printLRStringLF(frontol.currentDocument.type.name+" №"+print.addCharLeft(frontol.currentDocument.number,0,8),
                               "Смена №"+print.addCharLeft(frontol.sessionNumber,0,4)," ");
  print.printLRStringLF("Откр. "+frontol.currentDocument.timeOpen,"Закр. "+frontol.currentDocument.timeClose," ");
  print.printLRStringLF("Зал: " + frontol.currentDocument.hallName,"Т.О.: " + frontol.currentDocument.hallPlaceName," ");
  print.printStringWordWrap("Магазин: " + frontol.currentDocument.enterprise.name);
  print.printStringWordWrap(frontol.currentDocument.enterprise.description);
  print.printLRStringLF("=","=","=");
}

function printPosition(print)
{
  if (frontol.currentDocument.position.storno == 1)
    print.printCenterString("СТОРНО"," ");
  print.printString(frontol.currentDocument.position.number+". "+frontol.currentDocument.position.ware.text);
  if (frontol.currentDocument.position.storno == 0)
  {
    print.printStringWordWrap(frontol.currentDocument.position.ware.code+" "+frontol.currentDocument.position.ware.mark+" "+frontol.currentDocument.position.barcode);
      for (frontol.currentDocument.position.aspect.index = 1;
           frontol.currentDocument.position.aspect.index <=
           frontol.currentDocument.position.aspect.count;
           frontol.currentDocument.position.aspect.index++)
      {
        if (frontol.currentDocument.position.aspect.code != 0)
          print.printStringWordWrap("    "+frontol.currentDocument.position.aspect.aspectText+": "+
                                frontol.currentDocument.position.aspect.text);
      }
    if (frontol.currentDocument.position.ware.series != "")
      print.printStringWordWrap("  "+"Серия "+frontol.currentDocument.position.ware.series);
    print.printLRStringLF("  "+(frontol.currentDocument.position.fracSale?print.formatQuantity(frontol.currentDocument.position.quantity):frontol.currentDocument.position.quantity)+"*"+
                          print.formatCurrency(frontol.currentDocument.position.price),
                          print.formatCurrency(frontol.currentDocument.position.sum),"_");
    for (frontol.currentDocument.position.discountPos.index = 1;
         frontol.currentDocument.position.discountPos.index <= frontol.currentDocument.position.discountPos.count;
         frontol.currentDocument.position.discountPos.index++)
    {
      if (frontol.currentDocument.position.discountPos.sum != 0)
      {
      if (frontol.currentDocument.position.discountPos.marketingAction != null)
        if(frontol.currentDocument.position.discountPos.marketingAction.text != "")
          print.printStringWordWrap("  "+frontol.currentDocument.position.discountPos.marketingAction.text);
          var discSuff;
          if (frontol.currentDocument.position.discountPos.valueType == 0)
            discSuff= "р";
          else
            discSuff= "%";
      if (frontol.currentDocument.position.discountPos.sum < 0)
        print.printLRStringLF("  "+"+"+print.formatPercent(-frontol.currentDocument.position.discountPos.value)+discSuff,
                                       print.formatCurrency(-frontol.currentDocument.position.discountPos.sum),"_");
      else
        print.printLRStringLF("  "+"-"+print.formatPercent(frontol.currentDocument.position.discountPos.value)+discSuff,
                                       print.formatCurrency(frontol.currentDocument.position.discountPos.sum),"_");
      }
    }
    if (frontol.currentDocument.position.discountPos.totalSum  != 0)
      if (frontol.currentDocument.position.discountPos.totalSum < 0)
        print.printLRStringLF("  "+"+"+print.formatPercent(frontol.currentDocument.position.discountPos.totalPercent)+"%",
               print.formatCurrency(-frontol.currentDocument.position.discountPos.totalSum),"_");
      else
        print.printLRStringLF("  "+"-"+print.formatPercent(frontol.currentDocument.position.discountPos.totalPercent)+"%",
                print.formatCurrency(frontol.currentDocument.position.discountPos.totalSum),"_");
    if (frontol.currentDocument.position.totalSumDiscount != 0)
      if (frontol.currentDocument.position.totalSumDiscount < 0)
        print.printLRStringLF("  "+"+"+print.formatPercent(-frontol.currentDocument.position.totalPercentDiscount)+"%",
               print.formatCurrency(-frontol.currentDocument.position.totalSumDiscount),"_");
      else
        print.printLRStringLF("  "+"-"+print.formatPercent(frontol.currentDocument.position.totalPercentDiscount)+"%",
                print.formatCurrency(frontol.currentDocument.position.totalSumDiscount),"_");
    if (frontol.currentDocument.position.totalSumDiscount != 0)
      print.printLRString("  "+"Итоговая сумма",print.formatCurrency(frontol.currentDocument.position.sumWithDiscs),"_");
    if (frontol.currentDocument.position.tax.count > 0)
    {
      print.printStringWordWrap("  "+"Включая налоги");
      print.printLRStringLF("    "+"База",print.formatCurrency(frontol.currentDocument.position.tax.baseSum),"_");
    }

    for(frontol.currentDocument.position.tax.index = 1;
        frontol.currentDocument.position.tax.index <=
        frontol.currentDocument.position.tax.count;
        frontol.currentDocument.position.tax.index++)
    {
      if (frontol.currentDocument.position.tax.taxRateValue != 0)
        print.printLRString("    "+frontol.currentDocument.position.tax.taxRateText,
              print.formatCurrency(frontol.currentDocument.position.tax.sum),"_");
    }

    if (frontol.currentDocument.position.tax.totalSum > 0)
      print.printLRStringLF("    "+"Итог ",print.formatCurrency(frontol.currentDocument.position.tax.totalSum),"_");
    if (frontol.currentDocument.position.number != frontol.currentDocument.position.count)
      print.printLRStringLF("-","-","-");
  }

}

function printFooter(print)
{
  {
  print.printLRStringLF("Позиций: "+frontol.currentDocument.quantityPositions,"Покупок: "+frontol.currentDocument.quantityBuys," ");
  print.printLRStringLF("=","=","=");
  for(frontol.currentDocument.aspect.index = 1;
      frontol.currentDocument.aspect.index <=
      frontol.currentDocument.aspect.count;
      frontol.currentDocument.aspect.index++)
  {
    if (frontol.currentDocument.aspect.text != "")
      print.printStringWordWrap(frontol.currentDocument.aspect.aspectText+": "+frontol.currentDocument.aspect.text);
   }
  if(frontol.currentDocument.cardValues != "")
    print.printStringWordWrap("Карта: "+frontol.currentDocument.cardValues);
  if(frontol.currentDocument.client.text != "")
    print.printStringWordWrap("Клиент: " + frontol.currentDocument.client.text);
  print.printLRStringLF("Сумма",print.formatCurrency(frontol.currentDocument.sum),"_");
  print.printLRStringLF("-","-","-");
  if(frontol.currentDocument.discountDoc.count > 0)
    print.printStringWordWrap("Скидки на документ");
  for (frontol.currentDocument.discountDoc.index = 1;
       frontol.currentDocument.discountDoc.index <= frontol.currentDocument.discountDoc.count;
       frontol.currentDocument.discountDoc.index++)
  {
    if (frontol.currentDocument.discountDoc.sum != 0)
    {
      if (frontol.currentDocument.discountDoc.marketingAction != null)
      if (frontol.currentDocument.discountDoc.marketingAction.text != "")
        print.printStringWordWrap(frontol.currentDocument.discountDoc.marketingAction.text);
      var discSuff;
      if (frontol.currentDocument.discountDoc.valueType == 0)
        discSuff= "р";
      else
        discSuff= "%";
      if (frontol.currentDocument.discountDoc.sum < 0)
        print.printLRStringLF("  "+"+"+print.formatPercent(-frontol.currentDocument.discountDoc.value)+discSuff,
                                       print.formatCurrency(-frontol.currentDocument.discountDoc.sum),"_");
      else
        print.printLRStringLF("  "+"-"+print.formatPercent(frontol.currentDocument.discountDoc.value)+discSuff,
                                       print.formatCurrency(frontol.currentDocument.discountDoc.sum),"_");
    }
  }
  if (frontol.currentDocument.discountDoc.count > 0)
    if (frontol.currentDocument.discountDoc.totalSum < 0)
      print.printLRStringLF("+"+print.formatPercent(-frontol.currentDocument.discountDoc.totalPercent)+"%",
                           print.formatCurrency(-frontol.currentDocument.discountDoc.totalSum),"_");
    else
      print.printLRStringLF("-"+print.formatPercent(frontol.currentDocument.discountDoc.totalPercent)+"%",
                            print.formatCurrency(frontol.currentDocument.discountDoc.totalSum),"_");
  if (frontol.currentDocument.totalSumDiscount != 0)
    if (frontol.currentDocument.totalSumDiscount < 0)
    {  print.printLRString("Сумма итоговой скидки",print.formatCurrency(-frontol.currentDocument.totalSumDiscount),"_");
      print.printLRString("+"+print.formatPercent(frontol.currentDocument.totalPercentDiscount)+"%",
                         print.formatCurrency(-frontol.currentDocument.totalSumDiscount),"_");
    }
    else
    {
      print.printLRString("Сумма итоговой скидки",print.formatCurrency(frontol.currentDocument.totalSumDiscount),"_");
      print.printLRString("-"+print.formatPercent(frontol.currentDocument.totalPercentDiscount)+"%",
                          print.formatCurrency(frontol.currentDocument.totalSumDiscount),"_");
    }
  if (frontol.currentDocument.sum != frontol.currentDocument.sumWithDiscs )
    print.printLRStringLF("Итоговая сумма",print.formatCurrency(frontol.currentDocument.sumWithDiscs),"_");
  if (frontol.currentDocument.sumPrepaid != 0)
    print.printLRStringLF("Предоплата",print.formatCurrency(frontol.currentDocument.sumPrepaid), "_");
  print.printLRStringLF("-","-","-");
  if (frontol.currentDocument.nonFiscalPayment.count > 0)
    print.printStringWordWrap("Нефискальные оплаты");
  for (frontol.currentDocument.nonFiscalPayment.index = 1;
       frontol.currentDocument.nonFiscalPayment.index <= frontol.currentDocument.nonFiscalPayment.count;
       frontol.currentDocument.nonFiscalPayment.index++)
  {
    if (frontol.currentDocument.nonFiscalPayment.sum != 0)
    {
      if (frontol.currentDocument.nonFiscalPayment.marketingAction != null)
        print.printStringWordWrap(frontol.currentDocument.nonFiscalPayment.marketingAction.text);
      if ((frontol.currentDocument.nonFiscalPayment.type.operation == 4) && (frontol.currentDocument.nonFiscalPayment.paymentSystem != null))
      {
        if (frontol.currentDocument.nonFiscalPayment.paymentSystem.text != "")
          print.printStringWordWrap(frontol.currentDocument.nonFiscalPayment.paymentSystem.text);
      else if (frontol.currentDocument.nonFiscalPayment.paymentSystem.name != "")
          print.printStringWordWrap(frontol.currentDocument.nonFiscalPayment.paymentSystem.name);
      }
      if (frontol.currentDocument.nonFiscalPayment.type.operation == 6)
      {
          print.printStringWordWrap("Подарочная карта " + frontol.currentDocument.nonFiscalPayment.giftCard.value);
      }
      print.printLRString("", print.formatCurrency(frontol.currentDocument.nonFiscalPayment.sum),"_");
    }
  }
  if (frontol.currentDocument.nonFiscalPayment.totalSum > 0)
      print.printLRStringLF("  "+print.formatPercent(frontol.currentDocument.nonFiscalPayment.totalPercent)+"%",
                            print.formatCurrency(frontol.currentDocument.nonFiscalPayment.totalSum),"_");
  if (frontol.currentDocument.nonFiscalPayment.totalSum != 0)
    {
      print.printLRString("Сумма нефискальных оплат",print.formatCurrency(frontol.currentDocument.nonFiscalPayment.totalSum),"_");
      print.printLRString(print.formatPercent(frontol.currentDocument.nonFiscalPayment.totalPercent)+"%",
                          print.formatCurrency(frontol.currentDocument.nonFiscalPayment.totalSum),"_");
    }
  print.printStringWordWrap("Оплата");
  for(frontol.currentDocument.payment.index = 1;
      frontol.currentDocument.payment.index <=
      frontol.currentDocument.payment.count;
      frontol.currentDocument.payment.index++)
  {
    if(frontol.currentDocument.payment.sumInBaseCurrency > 0)
    {
      print.printStringWordWrap("  "+frontol.currentDocument.payment.type.text+", "+frontol.currentDocument.payment.paymentCurrency.text);
      if(frontol.baseCurrency.rateMul != "1")
        print.printLRStringLF("  "+print.formatCurrency(frontol.currentDocument.payment.sumInPaymentCurrency)+" по "+
                                             frontol.currentDocument.payment.paymentCurrency.rateMul+"/"+frontol.baseCurrency.rateMul,
                           "="+print.formatCurrency(frontol.currentDocument.payment.sumInBaseCurrency),"_");
      else
        print.printLRStringLF("  "+print.formatCurrency(frontol.currentDocument.payment.sumInPaymentCurrency)+" по "+
                                              frontol.currentDocument.payment.paymentCurrency.rateMul,
                           "="+print.formatCurrency(frontol.currentDocument.payment.sumInBaseCurrency),"_");
    }
    else
    {
      print.printStringWordWrap("Сдача");
      print.printStringWordWrap("  "+frontol.currentDocument.payment.type.text+", "+frontol.currentDocument.payment.paymentCurrency.text);
      if(frontol.baseCurrency.rateMul != "1")
        print.printLRStringLF("  "+print.formatCurrency(-frontol.currentDocument.payment.sumInPaymentCurrency)+" по "+
                                              frontol.currentDocument.payment.paymentCurrency.rateMul+"/"+frontol.baseCurrency.rateMul,
                           "="+print.formatCurrency(-frontol.currentDocument.payment.sumInBaseCurrency),"_");
      else
        print.printLRStringLF("  "+print.formatCurrency(-frontol.currentDocument.payment.sumInPaymentCurrency)+" по "+
                                              frontol.currentDocument.payment.paymentCurrency.rateMul,
                           "="+print.formatCurrency(-frontol.currentDocument.payment.sumInBaseCurrency),"_");
    }
  }
  print.printLRStringLF("-","-","-");
  for(frontol.currentDocument.tax.index = 1;
      frontol.currentDocument.tax.index <=
      frontol.currentDocument.tax.count;
      frontol.currentDocument.tax.index++)
  {
    if(frontol.currentDocument.tax.index == 1)
      print.printStringWordWrap("Включая налоги");
    if (frontol.currentDocument.tax.sum != 0)
      print.printLRString("  "+frontol.currentDocument.tax.taxRateText,
                       print.formatCurrency(frontol.currentDocument.tax.sum),"_");
    if(frontol.currentDocument.tax.index == frontol.currentDocument.tax.count)
      print.printLRString("  "+"Итог",print.formatCurrency(frontol.currentDocument.tax.totalSum),"_");
  }
  for(frontol.currentDocument.servicePrintInfo.index = 1;
      frontol.currentDocument.servicePrintInfo.index <= frontol.currentDocument.servicePrintInfo.count;
      frontol.currentDocument.servicePrintInfo.index++)
     if (frontol.currentDocument.servicePrintInfo.printGroup.code == print.printGroup.code)
     {
       print.printLRStringLF("—","—","—");
       print.printCenterString("Услуги", " ");
       print.printString(frontol.currentDocument.servicePrintInfo.info);
     }
  print.printLRStringLF("-","-","-");
  if (frontol.currentDocument.bonus.count > 0)
    print.printStringWordWrap("Начисление бонусов");
  for (frontol.currentDocument.bonus.index = 1;
       frontol.currentDocument.bonus.index <= frontol.currentDocument.bonus.count;
       frontol.currentDocument.bonus.index++)
  {
    if (frontol.currentDocument.bonus.sum != 0)
    {
      if ((frontol.currentDocument.bonus.type == 0) && (frontol.currentDocument.nonFiscalPayment.marketingAction != null))
        if (frontol.currentDocument.bonus.marketingAction.text != "")
           print.printLRStringLF(frontol.currentDocument.bonus.marketingAction.text,print.formatCurrency(frontol.currentDocument.bonus.sum), "_");
      if (frontol.currentDocument.bonus.type == 1)
      { if (frontol.currentDocument.bonus.paymentSystem.text != "")
           print.printLRStringLF(frontol.currentDocument.bonus.paymentSystem.text,print.formatCurrency(frontol.currentDocument.bonus.sum), "_");
        else if (frontol.currentDocument.bonus.paymentSystem.name != "")
          print.printLRStringLF(frontol.currentDocument.bonus.paymentSystem.name,print.formatCurrency(frontol.currentDocument.bonus.sum), "_");
      }
    }
  }
  if (frontol.currentDocument.bonus.count > 0 )
    print.printCenterString("Начисленные бонусы"," ");
  }
}

